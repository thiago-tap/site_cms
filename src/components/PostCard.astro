---
import { formatDate, parseTags } from '../lib/utils';

interface Props {
  post: {
    id: string;
    title: string;
    slug: string;
    excerpt: string | null;
    coverImage: string | null;
    tags: string;
    views: number;
    readingTime: number;
    publishedAt: number | null;
  };
}

const { post } = Astro.props;
const tags = parseTags(post.tags);
---

<a href={`/blog/${post.slug}`} class="group block h-full">
  <article class="bg-zinc-900 border border-zinc-800 rounded-xl overflow-hidden hover:border-indigo-500/40 transition-all h-full flex flex-col">
    {post.coverImage && (
      <div class="aspect-video overflow-hidden bg-zinc-800 shrink-0">
        <img
          src={post.coverImage}
          alt={post.title}
          loading="lazy"
          class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"
        />
      </div>
    )}

    <div class="p-5 flex flex-col flex-1">
      <h2 class="text-lg font-semibold text-zinc-100 group-hover:text-indigo-400 transition-colors mb-2 line-clamp-2">
        {post.title}
      </h2>

      {post.excerpt && (
        <p class="text-sm text-zinc-400 line-clamp-2 mb-4">{post.excerpt}</p>
      )}

      <div class="mt-auto">
        {tags.length > 0 && (
          <div class="flex flex-wrap gap-1.5 mb-3">
            {tags.slice(0, 4).map((tag) => (
              <span class="text-xs bg-zinc-800 text-zinc-500 px-2 py-0.5 rounded-md">#{tag}</span>
            ))}
          </div>
        )}

        <div class="flex items-center gap-4 text-xs text-zinc-600">
          {post.publishedAt && (
            <span>{formatDate(post.publishedAt)}</span>
          )}
          <span>{post.readingTime} min de leitura</span>
          <span class="flex items-center gap-1">
            <svg class="w-3 h-3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/>
            </svg>
            {post.views}
          </span>
        </div>
      </div>
    </div>
  </article>
</a>
