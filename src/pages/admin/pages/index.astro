---
import Header from '../../../components/Header.astro';
import AdminNav from '../../../components/admin/AdminNav.astro';
import { getDb, pages } from '../../../lib/db';
import '../../../styles/global.css';

const db = getDb(Astro.locals.runtime.env.DB);
const allPages = await db.select().from(pages).all();
---

<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Páginas — Admin</title>
  <link rel="icon" href="/favicon.svg" type="image/svg+xml" />
</head>
<body class="bg-zinc-950 text-zinc-100 min-h-screen">
  <Header />

  <div class="max-w-5xl mx-auto px-4 py-8 flex gap-8">
    <AdminNav />

    <div class="flex-1 min-w-0">
      <h1 class="text-2xl font-bold mb-8">Páginas</h1>

      <div class="space-y-2">
        {allPages.map((page) => (
          <a
            href={`/admin/pages/${page.slug}`}
            class="flex items-center justify-between bg-zinc-900 border border-zinc-800 hover:border-zinc-700 rounded-lg px-4 py-3 transition-colors group"
          >
            <div>
              <p class="text-sm font-medium text-zinc-200 group-hover:text-zinc-100">{page.title}</p>
              <p class="text-xs text-zinc-600 mt-0.5">/{page.slug}</p>
            </div>
            <span class="text-xs text-indigo-400">Editar →</span>
          </a>
        ))}
      </div>

      <p class="mt-6 text-xs text-zinc-600">
        As páginas <strong class="text-zinc-500">Sobre</strong> e <strong class="text-zinc-500">Contato</strong> são criadas automaticamente.
        O conteúdo suporta Markdown.
      </p>
    </div>
  </div>
</body>
</html>
